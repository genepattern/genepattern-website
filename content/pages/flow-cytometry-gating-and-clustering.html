<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Flow Cytometry Gating and Clustering</title>
</head>
<body>
<h2>Description</h2>

<p>Gating is an inherent component of FCM data analysis; it is a process where particles (i.e., cells) are subsetted according to physical and fluorescence characteristics. These properties are reflected in parameter values of events stored in FCS files. In practice, gating corresponds to assigning classes (labels) to these events. This can be done either manually or automatically. While manual gating is still dominant in traditional FCM, automatic gating methods are becoming more important in contemporary and high throughput approaches. This suite supports the application of manually created gates saved in Gating-ML as well as a variety of clustering algorithms developed for the use with flow cytometry data.<br />
(Click <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /> for documents)</p>

<h3>Manual gating</h3>

<ul>
	<li><strong>ApplyGatingML</strong> applies a Gating-ML file to FCS data to gate (filter) and/or transform it. Each gate in the Gating-ML file creates a population saved in a CSV file. <a href="ftp://ftp.broadinstitute.org/pub/genepattern/modules_public_server_doc/ApplyGatingML.pdf" target="_blank" type="application-pdf"> <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
</ul>

<h3>Clustering</h3>

<ul>
	<li><strong>FlowClustClassifyFCS</strong> uses the model-based FlowClust algorithm to find populations in an FCS file. <a href="ftp://ftp.broadinstitute.org/pub/genepattern/modules_public_server_doc/FlowClustClassifyFCS.pdf" target="_blank" type="application-pdf"> <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
	<li><strong>FlowMeansCluster</strong> clusters flow cytometry data using the FlowMeans algorithm. This algorithm applies a nonparametric approach to perform automated gating of cell populations in flow cytometry data. Clustering results are obtained by counting the number of modes in every single dimension, followed by multi-dimensional clustering. Then adjacent clusters (in terms of Euclidean or Mahalanobis distance) are merged. The number of clusters is determined using a change point detection algorithm based on piecewise linear regression. This approach allows multiple clusters to represent the same population and enables the algorithm to find non-spherical cell populations. <a href="ftp://ftp.broadinstitute.org/pub/genepattern/modules_public_server_doc/FlowMeansCluster.pdf" target="_blank" type="application-pdf"> <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
	<li><strong>FlowMergeCluster</strong> uses the FlowMerge algorithm to cluster&nbsp;flow cytometry data. The max BIC model fitting criterion for mixture models generally overestimates the number of cell populations in flow cytometry data because the number of mixture components required to accurately model a distribution is usually greater than the number of distinct cell populations. Model fitting criteria based on the entropy, such as the ICL, provide better estimates of the number of clusters but tend to provide a poor fit to the underlying distribution. FlowMerge combines these two approaches by merging mixture components from the max BIC fit based on an entropy criterion. This approach allows multiple mixture components to represent the same cell subpopulation. Merged clusters are mixtures themselves and are summarized by a weighted combination of their component model parameters. The result is a mixture model that retains the good model fitting properties of the max BIC solution but the number of components more closely reflects the true number of distinct cell subpopulations. <a href="ftp://ftp.broadinstitute.org/pub/genepattern/modules_public_server_doc/FlowMergeCluster.pdf" target="_blank" type="application-pdf"> <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
	<li><strong>ImmPortFLOCK</strong> is a GenePattern implementation of FLOCK version 1 method at the&nbsp;Immunology Database and Analysis Portal (ImmPort). FLOCK is a grid-based density clustering method for automated population identification from multi-dimensional FCM data. It has been used to objectively identify seventeen distinct B cell subsets in a human peripheral blood sample and to identify and quantify novel plasmablast subsets responding transiently to tetanus vaccinations and other vaccinations in peripheral blood. The use of algorithms like FLOCK for FCM data analysis obviates the need for subjective and labor intensive manual gating to identify and quantify cell subsets. Novel populations identified by these computational approaches can serve as hypotheses for further experimental study. <a href="http://genepattern.broadinstitute.org/gp/module/doc/urn:lsid:broad.mit.edu:cancer.software.genepattern.module.analysis:00307" target="_blank" type="application-pdf"> <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
	<li><strong>KMeansClassifyFCS</strong> uses the K-Means algorithm to find populations in an FCS file. <a href="ftp://ftp.broadinstitute.org/pub/genepattern/modules_public_server_doc/KMeansClassifyFCS.pdf" target="_blank" type="application-pdf"> <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
	<li><strong>SamSPECTRALClusterFCS</strong> uses the SamSPECTRAL algorithm, which is a modification of spectral clustering, to cluster flow cytometry data. Spectral clustering is a non-parametric clustering method which has proved useful in many pattern recognition areas. It does not require a priori assumptions on the size, shape, and distributions of clusters and it is not sensitive to outliers or noise. However, there are serious empirical barriers in applying spectral clustering for large data sets, such as commonly present in flow cytometry.&nbsp;<a href="ftp://ftp.broadinstitute.org/pub/genepattern/modules_public_server_doc/SamSPECTRALClusterFCS.pdf" target="_blank" type="application-pdf"><img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
	<li><strong>SuggestNumberOfPopulationsFCS</strong> suggests the number of clusters (K value) for a clustering algorithm. It tests a range of several K values and suggests a number of populations using the Bayesian Information Criterion (BIC) in combination with the FlowClust algorithm. In addition, it outputs the estimated BIC as well as the Integrated Completed Likelihood (ICL) score for each of the K values <a href="ftp://ftp.broadinstitute.org/pub/genepattern/modules_public_server_doc/SuggestNumberOfPopulationsFCS.pdf" target="_blank" type="application-pdf"> <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
</ul>

<h3>Meta-clustering</h3>

<ul>
	<li><strong>ImmPortCrossSample</strong> applies centroids of an FCM data clustering result to a new FCM data file (TXT generated from FCS) for population identification and mapping between the two samples. The module is a GenePattern implementation of the cross-sample comparison method at the&nbsp;Immunology Database and Analysis Portal (ImmPort). <a href="http://genepattern.broadinstitute.org/gp/module/doc/urn:lsid:broad.mit.edu:cancer.software.genepattern.module.analysis:00305" target="_blank" type="application-pdf"> <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
	<li><strong>MClustClusterLabel</strong> performs a model-based labeling (matching) of clustered flow cytometry data. Independent clustering of a several flow cytometry samples (e.g., blood from different patients) typically results in dividing each of the FCS files into several groups corresponding to cell sub populations in each of the particular sample. This module will match these clustering results across different samples. <a href="ftp://ftp.broadinstitute.org/pub/genepattern/modules_public_server_doc/MClustClusterLabel.pdf" target="_blank" type="application-pdf"> <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
	<li><strong>MClustClusterLabelBIC</strong> uses the Bayesian Information Criterion (BIC) for model-based labeling of clusters, i.e., it estimates the number of labels for MClustClusterLabel. <a href="ftp://ftp.broadinstitute.org/pub/genepattern/modules_public_server_doc/MClustClusterLabelBIC.pdf" target="_blank" type="application-pdf"> <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
</ul>

<h3>Feature extraction</h3>

<ul>
	<li><strong>FCMFeatureExtraction</strong> extracts features from gated flow cytometry data. These features typically include the number of events (cells) in each of the sub-population, the proportion (percentage) of events in each of the sub-population, and/or the mean value of (each or selected) parameters (e.g., the Mean Fluorescence Intensity&nbsp;[MFI]) of each of the sub-population. <a href="ftp://ftp.broadinstitute.org/pub/genepattern/modules_public_server_doc/FCMFeatureExtraction.pdf" target="_blank" type="application-pdf"> <img src="/uploaded/content_pdf.jpg" style="border-width: 0px; border-style: solid;" /></a></li>
</ul>

<h2>References</h2>

<ul>
	<li><strong>FCS: </strong>Spidlen J, Moore W, Parks D, Goldberg M, Bray C, Bierre P, Gorombey P, Hyun B, Hubbard M, Lange S, Lefebvre R, Leif RR, Novo D, Ostruszka L, Treister A, Wood J, Murphy RF, Roederer M, Sudar D, Zigon R, Brinkman RR. &nbsp;<a href="http://www.ncbi.nlm.nih.gov/pubmed/19937951" target="_blank">Data File Standard for Flow Cytometry, Version FCS 3.1.</a>&nbsp;<em>Cytometry&nbsp;A</em>. 2010;77:97&ndash;100.</li>
	<li><strong>Gating-ML: </strong>Spidlen J, Leif RC, Moore W, Roederer M,&nbsp;International Society for the Advancement of Cytometry Data Standards Task Force, Brinkman RR.&nbsp;<a href="http://www.ncbi.nlm.nih.gov/pubmed/18773465" target="_blank">Gating-ML: XML-based gating descriptions in flow cytometry.</a>&nbsp;<em>Cytometry&nbsp;A</em>.&nbsp;2008;73A(12):1151-1157.</li>
	<li><strong>FlowClust: </strong>Lo K,&nbsp;Brinkman RR,&nbsp;Gottardo R.&nbsp;<a href="http://www.ncbi.nlm.nih.gov/pubmed/18773465" target="_blank">Automated gating of flow cytometry data via robust model-based clustering.</a>&nbsp;&nbsp;<em>Cytometry A</em>.&nbsp;2008;73(4):321-332.</li>
	<li><strong>FlowMeans: </strong>Aghaeepour N, Nikolic R, Hoos HH, Brinkman RR.&nbsp; <a href="http://www.ncbi.nlm.nih.gov/pubmed/21182178" target="_blank">Rapid cell population identification in flow cytometry data.</a>&nbsp;<em>Cytometry A</em>.&nbsp;2011;79(1):6-13.</li>
	<li><strong>FlowMerge: </strong>Finak G, Bashashati A, Brinkman R, Gottardo R.&nbsp; <a href="http://www.ncbi.nlm.nih.gov/pubmed/20049161" target="_blank">Merging mixture components for cell population identification in flow cytometry.</a>&nbsp; <em>Adv Bioinformatics</em>. 2009;247646. Epub 2009 Nov 12.</li>
	<li><strong>ImmPortFLOCK: </strong>Qian Y, Wei C, Eun-Hyung Lee F, Campbell J, Halliley J, Lee JA, Cai J, Kong YM, Sadat E, Thomson E, Dunn P, Seegmiller AC, Karandikar NJ, Tipton CM, Mosmann T, Sanz I, Scheuermann RH. <a href="http://www.ncbi.nlm.nih.gov/pubmed/20839340" target="_blank">Elucidation of seventeen human peripheral blood B-cell subsets and quantification of the tetanus response using a density-based method for the automated identification of cell populations in multidimensional flow cytometry data.</a>&nbsp; <em>Cytometry B Clin Cytom</em>. 2010;78 Suppl 1:S69-82.</li>
	<li><strong>SamSPECTRAL: </strong>Zare H, Shooshtari P, Gupta A, Brinkman RR.&nbsp; <a href="http://www.ncbi.nlm.nih.gov/pubmed/20667133" target="_blank">Data reduction for spectral clustering to analyze high throughput flow cytometry data.</a>&nbsp;<em>BMC Bioinformatics</em>. 2010 Jul 28;11:403.</li>
	<li><a href="http://www.broadinstitute.org/genepattern/desc/quick_start.html" target="_blank">Quick Start</a> a 10-minute introduction to GenePattern</li>
</ul>
</body>
</html>